<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <title>Livros listados</title>
    <%- include('../views/head'); %>
</head>
<body>
    <%- include('../views/nav'); %>
    <div class="text-center pt-4">
        <h2>Livros listados</h2>
        <p class="lead">Segue abaixo relação de livros já incluídos</p>
    </div>
    <table class="table table-hover" style="margin: 0 auto; width: 70%;">
        <thead class="table-dark">    
            <tr>
                <th style="width: 30%">Título</th>
                <th style="width: 20%">Autor</th>
                <th style="width: 10%">Categoria</th>
                <th style="width: 40%">Resumo</th>
                <th colspan="2" style="width: 20%">Opções</th>
            </tr>
        </thead>
        <tbody>
    <% for (livro of lista){ %>
            <tr>    
                <td><%- livro.titulo %></td>
                <td><%- livro.autor %></td>
                <td><%- livro.categoria %></td>
                <td><%- livro.resumo %></td>

                <td><a href='#' onclick="deletar(<%- livro.id %>)"><img src="/_img/x-circle.svg" style="width: 20px;"></a></td>    
            </tr>
    <% } %>
        </tbody>
    </table>
    <div  class="text-center">

    <a href="/index" class="btn btn-outline-secondary" style="margin-top: 10px; margin-bottom: 10px;">Voltar</a>
    
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
<footer>
    <%- include('../views/footer'); %>
</footer>
</body>
</html>

<script>
    function deletar(id) {
        const answer = confirm("Deseja realmente excluir este registro id " + id + "?");
        if (answer) {
            $.ajax({   
                type:'DELETE', 
                url: `/exclusao/${id}`,
                success: function (resultado) {
                    if(resultado == 'OK') {
                        window.location.reload();
                    }else{
                        alert(resultado)
                    }
                }
            });
        };
    }
</script> 